!function(a,b){"function"===typeof define&&define.amd?define(["leaflet"],function(c){return a.L.TileLayer.Fallback=b(c)}):"object"===typeof module&&module.exports?module.exports=b(require("leaflet")):a.L.TileLayer.Fallback=b(a.L)}(this,function(a){var b=a.TileLayer,c=b.prototype,d=b.extend({statics:{version:"0.1.0"},options:{minNativeZoom:0},initialize:function(a,b){c.initialize.call(this,a,b)},_loadTile:function(a,b){c._loadTile.call(this,a,b),a._originalTilePoint=b,a._originalSrc=a.src},_tileOnError:function(){var h,i,j,b=this._layer,c=this._originalTilePoint,d=this._tilePoint=this._tilePoint||a.extend({},c),e=this._fallbackZoom=(this._fallbackZoom||c.z)-1,f=this._fallbackScale=2*(this._fallbackScale||1),g=b._getTileSize();return e<b.options.minNativeZoom?(b.fire("tileerror",{tile:this,url:this.src}),h=b.options.errorTileUrl,h&&(this.src=h),void b._tileLoaded()):(d.z=e,d.x=Math.floor(d.x/2),d.y=Math.floor(d.y/2),h=b.getTileUrl(d),this.style.width=this.style.height=g*f+"px",i=(c.y-d.y*f)*g,this.style.marginTop=-i+"px",j=(c.x-d.x*f)*g,this.style.marginLeft=-j+"px",this.style.clip="rect("+i+"px "+(j+g)+"px "+(i+g)+"px "+j+"px)",b.fire("tilefallback",{tile:this,url:this._originalSrc,urlMissing:this.src,urlFallback:h}),void(this.src=h))},_resetTile:function(a){var b=this._getTileSize()+"px";delete a._originalTilePoint,delete a._fallbackZoom,delete a._fallbackScale,a.style={width:b,height:b}}});return a.tileLayer.fallback=function(a,b){return new d(a,b)},d});
